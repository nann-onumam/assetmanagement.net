<p-toast></p-toast>

<p-dialog
  [(visible)]="visible"
  (onHide)="onDialogHide()"
  [modal]="true"
  [style]="{ width: '600px', 'max-width': '90vw' }"
  [breakpoints]="{ '960px': '75vw', '640px': '90vw' }"
  [draggable]="false"
  [resizable]="false"
  [closeOnEscape]="true"
  styleClass="modern-asset-dialog">

  <!-- Custom Header -->
  <ng-template pTemplate="header">
    <div class="dialog-header">
      <div class="header-content">
        <div class="header-icon">
          <i class="pi pi-box" style="font-size: 2rem; color: #10b981;"></i>
        </div>
        <div class="header-text">
          <h3 class="header-title">{{ isEditMode ? 'Edit Asset' : 'Add New Asset' }}</h3>
          <p class="header-subtitle">{{ isEditMode ? 'Update your asset details below' : 'Fill in the information to create a new asset' }}</p>
        </div>
      </div>
    </div>
  </ng-template>

  <!-- Form Content -->
  <div class="form-content">
    <form [formGroup]="assetForm" class="asset-form">

      <!-- Asset Name Field -->
      <div class="field">
        <label for="name" class="field-label">
          Asset Name <span class="required">*</span>
        </label>
        <span class="p-input-icon-left w-full">
          <i class="pi pi-tag"></i>
          <input
            pInputText
            id="name"
            formControlName="name"
            placeholder="Enter asset name"
            class="form-input"
            [ngClass]="{ 'ng-invalid': isFieldInvalid('name') }" />
        </span>
        <small class="field-error" *ngIf="isFieldInvalid('name')">
          {{ getErrorMessage('name') }}
        </small>
      </div>

      <!-- Two Column Grid for Model and Value -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">

        <!-- Model Field -->
        <div class="field">
          <label for="model" class="field-label">
            Model <span class="required">*</span>
          </label>
          <span class="p-input-icon-left w-full">
            <i class="pi pi-cog"></i>
            <input
              pInputText
              id="model"
              formControlName="model"
              placeholder="Enter model name"
              class="form-input"
              [ngClass]="{ 'ng-invalid': isFieldInvalid('model') }" />
          </span>
          <small class="field-error" *ngIf="isFieldInvalid('model')">
            {{ getErrorMessage('model') }}
          </small>
        </div>

        <!-- Value Field -->
        <div class="field">
          <label for="value" class="field-label">
            Value (USD) <span class="required">*</span>
          </label>
          <span class="p-input-icon-left w-full">
            <i class="pi pi-dollar"></i>
            <p-inputNumber
              formControlName="value"
              mode="currency"
              currency="USD"
              locale="en-US"
              [useGrouping]="true"
              placeholder="0.00"
              class="form-input"
              [ngClass]="{ 'ng-invalid': isFieldInvalid('value') }">
            </p-inputNumber>
          </span>
          <small class="field-error" *ngIf="isFieldInvalid('value')">
            {{ getErrorMessage('value') }}
          </small>
        </div>

      </div>

      <!-- Category Dropdown -->
      <div class="field">
        <label for="categoryId" class="field-label">
          Category <span class="required">*</span>
        </label>
        <span class="p-input-icon-left w-full">
          <i class="pi pi-folder"></i>
          <p-select
            [options]="categories"
            formControlName="categoryId"
            optionLabel="name"
            optionValue="id"
            placeholder="Select a category"
            class="form-input"
            [ngClass]="{ 'ng-invalid': isFieldInvalid('categoryId') }">
          </p-select>
        </span>
        <small class="field-error" *ngIf="isFieldInvalid('categoryId')">
          {{ getErrorMessage('categoryId') }}
        </small>
      </div>

      <!-- Description Field -->
      <div class="field">
        <label for="description" class="field-label">Description</label>
        <span class="p-input-icon-left w-full">
          <i class="pi pi-align-left"></i>
          <textarea
            pInputTextarea
            id="description"
            formControlName="description"
            placeholder="Enter asset description (optional)"
            rows="3"
            class="form-input"
            [ngClass]="{ 'ng-invalid': isFieldInvalid('description') }">
          </textarea>
        </span>
        <small class="field-error" *ngIf="isFieldInvalid('description')">
          {{ getErrorMessage('description') }}
        </small>
      </div>

    </form>
  </div>

  <!-- Modern Footer with Actions -->
  <ng-template pTemplate="footer">
    <div class="dialog-footer">
      <p-button
        label="Cancel"
        icon="pi pi-times"
        severity="secondary"
        outlined="true"
        size="small"
        (onClick)="onCancel()"
        [disabled]="isSubmitting"
        styleClass="cancel-btn">
      </p-button>
      <p-button
        [label]="isEditMode ? 'Update Asset' : 'Create Asset'"
        icon="pi pi-check"
        severity="success"
        size="small"
        [loading]="isSubmitting"
        (onClick)="onSubmit()"
        [disabled]="assetForm.invalid || isSubmitting"
        styleClass="save-btn">
      </p-button>
    </div>
  </ng-template>
</p-dialog>